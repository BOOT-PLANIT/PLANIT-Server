# ---------------------------------------------------------------- #
# CodeRabbit Global Config
# ---------------------------------------------------------------- #
version: 1.1.0  # 설정 파일 버전, 버전 관리 용도로 사용합니다.
language: "ko-KR"  # 기본 언어 설정. 코드 리뷰와 커뮤니케이션의 언어를 설정합니다.

# ---------------------------------------------------------------- #
# 페르소나 및 톤
# ---------------------------------------------------------------- #
persona:
  role: "Planit 백엔드 코치"  # 이 설정은 리뷰어의 역할을 정의합니다. 실제 코칭 역할을 맡을 팀원에 맞게 변경 가능.
  tone: >
    리뷰는 구체적·논리적·교육적이어야 하며, 문제 원인과 개선책을 함께 제시합니다. 공식 문서 기반 피드백을 권장합니다. 

# ---------------------------------------------------------------- #
# 리뷰 설정
# ---------------------------------------------------------------- #
reviews:
  profile: "chill"  # 리뷰 스타일. 'chill'은 덜 엄격하고 부드러운 피드백을 제공합니다.
  request_changes_workflow: false  # 코드에 변경 요청이 있을 때 워크플로우 설정을 위한 옵션. 기본값: 변경 요청 후 승인 대기.
  high_level_summary: true  # PR 변경 사항에 대해 전반적인 요약을 생성합니다.
  changed_files_summary: false  # 변경된 파일에 대한 요약을 별도로 생성하지 않도록 설정합니다.
  sequence_diagrams: false  # 코드 흐름에 대한 시퀀스 다이어그램을 생성하지 않도록 설정합니다.
  poem: false  # 리뷰 요약에 시적 요소를 포함하지 않도록 설정합니다.
  assess_linked_issues: true  # 연결된 이슈를 분석하여 리뷰에 활용합니다.

  # 리뷰가 자동으로 진행되도록 설정
  auto_review:
    enabled: true  # PR이 생성될 때 자동으로 리뷰를 시작합니다.
    auto_incremental_review: true  # 이미 리뷰된 PR에 새로운 커밋이 추가되면 변경된 부분만 리뷰합니다.

    # 경로별 코드 리뷰 지침을 설정
    path_instructions:
      # ────────────────────────────────
      # Java/Spring Boot 관련 경로 설정
      # ────────────────────────────────
      - path: "src/main/java/**"  # Java/Spring Boot 소스 파일에 대한 리뷰 지침
        instructions: |
          1. **코드 컨벤션**: docs/code-convention.md 및 Spring 공식 문서 준수.  
          2. **품질 검토**: 가독성, Null-safety, 예외 처리, 테스트 가능성, 유지보수성. 
          3. **성능 검토**: JPA N+1, 불필요한 객체 생성, 컬렉션/스트림 최적화. 
          4. **보안 검토**: SQL Injection, CSRF, XSS 등 주요 취약점.  
          5. **추가 고려**: 최신 Java/Spring 트렌드, Javadoc, 로깅 규약. 
          6. 리뷰는 핵심만, 나머지는 캡션 처리.  

  tools:
    gitleaks:
      enabled: true  # Git 리포지토리에서 비밀 정보(Secrets) 유출을 검사하는 툴 활성화.
      severity: "high"  # 유출된 정보의 심각도 수준을 'high'로 설정 (더 민감한 정보에 대해 경고)

# ---------------------------------------------------------------- #
# 채팅 기능
# ---------------------------------------------------------------- #
chat:
  auto_reply: true  # GitHub에서 자동으로 답변을 달 수 있도록 설정. (PR 또는 이슈에서 자동 답변 활성화)
  prompt_style: "coach"  # 응답 스타일을 '코치'로 설정하여 교육적인 피드백을 제공합니다.
  feedback_mode: "constructive"  # 피드백 모드를 '구성적'으로 설정하여 긍정적인 변화를 유도하는 피드백을 제공합니다.

# ---------------------------------------------------------------- #
# Knowledge Base
# ---------------------------------------------------------------- #
knowledge_base:
  web_search:
    enabled: true  # 웹 검색을 통해 최신 정보나 문서를 참조할 수 있도록 설정.
  code_guidelines:
    enabled: true  # 코드 컨벤션 문서나 팀 스타일 가이드가 있을 경우 이를 기반으로 피드백.
    filePatterns:
      - "docs/code-convention.md"  # 코드 컨벤션 문서의 위치 설정.
  learnings:
    scope: "local"  # 학습한 내용은 로컬 프로젝트에 한정되어 저장됩니다.
  issues:
    scope: "local"  # 이슈 정보는 로컬 프로젝트에 한정되어 참조됩니다.
  pull_requests:
    scope: "local"  # PR 정보는 로컬 프로젝트에 한정되어 참조됩니다.
